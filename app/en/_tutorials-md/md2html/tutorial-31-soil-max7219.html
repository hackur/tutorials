<hr>
<p>tag: tutorial
src: tutorial-31-soil-max7219.html
title: Visualizing soil moisture with an LED matrix
banner: tutorial-31-01.jpg
img: tutorial-31-01s.jpg</p>
<h2>date: 20160623</h2>
<!-- @@master  = ../../_layout.html-->
<!-- @@block  =  meta-->
<title>Project Example 31: Visualizing soil moisture with an LED matrix :::: Webduino = Web × Arduino</title>

<meta name="description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image.">

<meta itemprop="description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image.">

<meta property="og:description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image.">

<meta property="og:title" content="Project Example 31: Visualizing soil moisture with an LED matrix" >

<meta property="og:url" content="https://webduino.io/tutorials/tutorial-31-soil-max7219.html">

<meta property="og:image" content="https://webduino.io/img/tutorials/tutorial-31-01s.jpg">

<meta itemprop="image" content="https://webduino.io/img/tutorials/tutorial-31-01s.jpg">

<include src="../_include-tutorials.html"></include>

<!-- @@close-->
<!-- @@block  =  preAndNext-->
<include src="../_include-tutorials-content.html"></include>

<!-- @@close-->
<!-- @@block  =  tutorials-->
<h1>Project Example 31: Visualizing soil moisture with an LED matrix</h1>
<p>Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image. </p>
<!-- <div class="buy-this">
    <span>土壤濕度偵測模組：<a href="https://webduino.io/buy/webduino-expansion-s.html" target="_blank">Webduino 擴充套件 S ( 支援馬克 1 號、Fly )</a></span>
    <span>LED 點矩陣：<a href="https://webduino.io/buy/webduino-package-plus.html" target="_blank">Webduino 基本套件 Plus  ( 支援馬克 1 號、Fly )</a></span>
    <span>Webduino 開發板：<a href="https://webduino.io/buy/component-webduino-v1.html" target="_blank">Webduino 馬克一號</a>、<a href="https://webduino.io/buy/component-webduino-fly.html" target="_blank">Webduino Fly</a>、<a href="https://webduino.io/buy/component-webduino-uno-fly.html" target="_blank">Webduino Fly + Arduino UNO</a></span>
</div> -->
<h2>Video Tutorial</h2>
<p>Watch the video tutorial here: 
<iframe class="youtube" src="https://www.youtube.com/embed/ppweeGJD0nw" frameborder="0" allowfullscreen></iframe></p>
<h2>Wiring and Practice</h2>
<p>The Soil Moisture Sensor has 3 pins, SIG, GND and VCC. Since we will be using an LED matrix to show the values, the LED matrix will also be using the GND and VCC. So, we will need to use a breadboard to make everything fit. Connect VCC to VCC, GND to GND, SIG from the soil moisture sensor to A3. For the LED matrix, connect DIN to 7, CS to 8, and CLK to 9.</p>
<p>Webduino Mark 1 Circuit Diagram:</p>
<p><img src="../../img/tutorials/tutorial-31-02.jpg" alt=""></p>
<p>Webduino Fly Circuit Diagram:</p>
<p><img src="../../img/tutorials/tutorial-31-02-fly.jpg" alt=""></p>
<p>Reference image:</p>
<p><img src="../../img/tutorials/tutorial-31-03.jpg" alt=""></p>
<p><img src="../../img/tutorials/tutorial-31-04.jpg" alt=""></p>
<p><img src="../../img/tutorials/tutorial-31-05.jpg" alt=""></p>
<p><img src="../../img/tutorials/tutorial-31-06.jpg" alt=""></p>
<!-- <div class="buy-this">
    <span>土壤濕度偵測模組：<a href="https://webduino.io/buy/webduino-expansion-s.html" target="_blank">Webduino 擴充套件 S ( 支援馬克 1 號、Fly )</a></span>
    <span>LED 點矩陣：<a href="https://webduino.io/buy/webduino-package-plus.html" target="_blank">Webduino 基本套件 Plus  ( 支援馬克 1 號、Fly )</a></span>
    <span>Webduino 開發板：<a href="https://webduino.io/buy/component-webduino-v1.html" target="_blank">Webduino 馬克一號</a>、<a href="https://webduino.io/buy/component-webduino-fly.html" target="_blank">Webduino Fly</a>、<a href="https://webduino.io/buy/component-webduino-uno-fly.html" target="_blank">Webduino Fly + Arduino UNO</a></span>
</div> -->
<h2>Instructions for using the Webduino Blockly</h2>
<p>Open the <a href="https://blockly.webduino.io/?lang=en">Webduino Blockly Editor</a>, place a &quot;Board&quot; block into the workspace and fill in the name of the  Webduino board you are using. Then place the &quot;Soil Moisture&quot; block from &quot;Sensors&quot; and the &quot;LED Matrix&quot; from &quot;Components&quot; inside and assign the correct pins to each of them.</p>
<p><img src="../../img/tutorials/en/tutorial-31-07.jpg" alt=""></p>
<p>Place a &quot;Soil Detects&quot; block into the stack using a variable representing the value currently measured, we also round this value to a whole number. We will be using this value repeatedly, so using the same variable allows us to change less code. We must round to a whole number because the LED matrix can only shows integers.</p>
<p><img src="../../img/tutorials/en/tutorial-31-08.jpg" alt=""></p>
<p>Then place a &quot;Show&quot; block from &quot;Show Text&quot; into the stack, so the measured value will simultaneously show on the &quot;Web Demo Area&quot; as well. Then add an &quot;If, do, else&quot; &quot;Logic&quot; block and connect the necessary &quot;Logic&quot;, &quot;Variable&quot;, &quot;LED Matrix&quot;, and &quot;Math&quot; blocks to the stack. When the values are less than 100, it will show the number on the LED matrix and when it is greater than or equal to 100, an animated image will play.</p>
<p><img src="../../img/tutorials/en/tutorial-31-09.jpg" alt=""></p>
<p>We&#39;ve finished most of the hard work, check if the board is online (click <a href="https://webduino.io/device.html">Check Device Status</a>) and click on the red execution button &quot;Run Blocks&quot;. If you take a glass of water and place the soil moisture sensor inside the water, you will see the values change. 
Solution: <a href="https://blockly.webduino.io/?lang=en#-KYlgaaXx61FlgO19A9h">https://blockly.webduino.io/?lang=en#-KYlgaaXx61FlgO19A9h</a></p>
<p>Be aware that different sensors will have different readings. Also if we connect VCC to 3.3V, the MAX value will also be different. If the values need to be converted, the &quot;Scale conversion&quot; block can be used as seen in these images.</p>
<p><img src="../../img/tutorials/en/tutorial-31-10.jpg" alt=""></p>
<p><img src="../../img/tutorials/en/tutorial-31-11.jpg" alt=""></p>
<h2>Code Explanation (<a href="https://bin.webduino.io/fijuw/edit?html,css,js,output">Check Webduino Bin</a>, <a href="https://webduino.io/device.html">Check Device Status</a>)</h2>
<p>Include <code>webduino-all.min.js</code> in the header of your html files in order to support all of the Webduino&#39;s components. If the codes are generated by Webduino Blockly, you also have to include <code>webduino-blockly.js</code> in your files.</p>
<pre><code>&lt;script src=&quot;https://webduino.io/components/webduino-js/dist/webduino-all.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://webduinoio.github.io/webduino-blockly/webduino-blockly.js&quot;&gt;&lt;/script&gt;
</code></pre><p>The first half of the code inside JavaScript are for the LED matrix to show images, the second half is for detection and measuring, we mainly use <code>on</code> to measure and it returns <code>val</code>.</p>
<pre><code>boardReady(&#39;&#39;, function (board) {
  board.systemReset();
  board.samplingInterval = 250;
  soil = getSoil(board, 3);
  matrix = getMax7219(board, 7, 8, 9);
  soil.on(function(val){
    soil.detectedVal = val;
    a = Math.round(soil.detectedVal);
    document.getElementById(&quot;demo-area-01-show&quot;).innerHTML = a;
    if (a &lt; 100) {
      matrix.animateStop();
      matrix.on(&quot;0000000000000000&quot;);
      matrix.on((max7219_number(a)));
    } else {
      matrix.animateStop();
      matrix.animate(max7219_horse(&quot;left&quot;,&quot;0c1e3e7c3e1e0c00&quot;),100);
    }
  });
});
</code></pre><p>This is how you can visualize soil moisture with an LED matrix!<br>Webduino Bin: <a href="https://bin.webduino.io/fijuw/edit?html,css,js,output">https://bin.webduino.io/fijuw/edit?html,css,js,output</a><br>Stack setup: <a href="https://blockly.webduino.io/?lang=en#-KYlgkLyhokqWK8p5WQh">https://blockly.webduino.io/?lang=en#-KYlgkLyhokqWK8p5WQh</a></p>
<!-- <div class="buy-this">
    <span>土壤濕度偵測模組：<a href="https://webduino.io/buy/webduino-expansion-s.html" target="_blank">Webduino 擴充套件 S ( 支援馬克 1 號、Fly )</a></span>
    <span>LED 點矩陣：<a href="https://webduino.io/buy/webduino-package-plus.html" target="_blank">Webduino 基本套件 Plus  ( 支援馬克 1 號、Fly )</a></span>
    <span>Webduino 開發板：<a href="https://webduino.io/buy/component-webduino-v1.html" target="_blank">Webduino 馬克一號</a>、<a href="https://webduino.io/buy/component-webduino-fly.html" target="_blank">Webduino Fly</a>、<a href="https://webduino.io/buy/component-webduino-uno-fly.html" target="_blank">Webduino Fly + Arduino UNO</a></span>
</div> -->
<!-- @@close-->